1) handle friends as the data comes in - Apaar
2) handle sending location data all the time - Apaar 
3) location backend(php for it) and then display on map
4) index page
5) protect all pages in template.php - Aniket